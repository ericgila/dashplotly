from dash import Dash, dcc, html,Output,Input
import relaxDash


app = Dash(__name__)
#data='/_IDsample,sample.titre,Export_sample.plus,ref,Export_FlagBad,sample.Fluence,time_m,N,N_e,Nt,Nt_e$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,510,0,0,0,0$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,525,126.2857143,6.392980845,1118.23089,59.91660265$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,555,121.7142857,6.167326679,1077.751944,57.79591548$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,585,133.6,2.6,1375.111851,35.96190401$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,615,132.1,2.6,1359.672721,35.78229282$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,645,123.9,2.5,1275.272143,34.03631303$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,675,115.2,2.4,1185.725189,32.23822003$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,695,132.9,2.8,1367.906923,37.43852257$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,717,126,2.87,1296.886925,37.22810795$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,745,117.2,2.7,1206.310695,34.87721736$CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,775,108.739,2.67,1119.223709,33.72750275$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,-,129,0,1.125E+11,990,0,0,0,0$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,-,129,0,1.125E+11,1000,0.942857143,0.047142857,8.348782663,0.442429133$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,-,129,0,1.125E+11,1020,2.742857143,0.137142857,24.28736775,1.287066568$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,-,129,0,1.125E+11,1040,3.371428571,0.168881468,29.85322286,1.584609846$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,-,129,0,1.125E+11,1065,3.797142857,0.190152819,33.62282472,1.784253256$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,-,129,0,1.125E+11,1090,4.751428571,0.237571429,42.07280475,2.229574691$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,-,129,0,1.125E+11,1125,5.942857143,0.297142857,52.62263012,2.788644231$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,490,0,0,0,0$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,510,0.1643125,0.009458813,1.454949312,0.087564852$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,530,0.28125,0.014823177,2.490403919,0.138347763$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,550,1.09375,0.054888025,9.684904131,0.514910201$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,570,1.5625,0.078265499,13.83557733,0.734366147$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,590,2.278125,0.114291401,20.17227175,1.072212643$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,615,2.71,0.056,23.99642532,0.650694415$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,675,2.787878788,0.147585402,24.68602404,1.376838971$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,740,2.704739937,0.157716878,23.94984867,1.458483119$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,765,2.579828132,0.157807623,22.84378344,1.453775132$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,810,2.48597829,0.127249892,22.01276472,1.191213715$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,900,2.278552691,0.119701289,20.17605885,1.117560009$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,938,2.560379919,0.134231466,22.67157399,1.253475748$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,998,2.90027137,0.151970559,25.68123445,1.419201883$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2,129,0,1.125E+11,1080,3.610601538,0.188801968,31.97104434,1.763525062$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,490,0,0,0,0$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,510,0.1643125,0.009458813,1.454949312,0.087564852$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,530,0.28125,0.014823177,2.490403919,0.138347763$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,550,1.09375,0.054888025,9.684904131,0.514910201$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,570,1.5625,0.078265499,13.83557733,0.734366147$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,590,2.278125,0.114291401,20.17227175,1.072212643$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,615,2.71,0.056,23.99642532,0.650694415$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,675,2.389424,0.066908805,21.15779874,0.699296536$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,740,2.172657194,0.084640308,19.23837864,0.822074652$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,765,2.05599403,0.090294728,18.20535321,0.861068457$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,810,1.934733134,0.05973147,17.13161593,0.608459736$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,900,1.619238806,0.06570863,14.33798638,0.633962293$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,938,1.749908955,0.069637585,15.49504043,0.67397633$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,998,2.024359254,0.081467566,17.92523456,0.787045267$CAR1505-g2,UO2-P-Xe-800-2.25e11--A3875-2,R2a,129,0,1.125E+11,1080,2.732607761,0.153945951,24.19661183,1.427826073$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,560,0,0,0,0$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,570,0.754722222,0.038873194,6.682891308,0.363663329$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,595,9.030555556,0.454932692,79.96348782,4.265983615$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,615,10.46,0.2,97.23351749,2.522006149$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,635,9.32,0.19,86.63636549,2.329162079$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,665,8.39,0.17,77.99132043,2.089418889$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,735,7.58,0.165,70.46176506,1.969158379$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,800,6.705,0.15,62.32798612,1.771306322$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,870,6.03,0.15,56.05335664,1.705685141$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,890,6.155,0.16,57.21532506,1.793784682$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,910,5.72,0.17,53.17167496,1.834587129$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,940,5.37,0.15,49.91816338,1.646102851$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,1000,5.446,0.15,50.62464018,1.652716888$CAR1505-g3,UO2-P-Xe-800-2.25e11--A3578-1,-,129,0,1.125E+11,1060,5.6638,0.18,52.64925395,1.910802696$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,560,0,0,0,0$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,570,5.144827586,0.257241379,45.55626235,2.414174432$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,595,45.75862069,2.288970218,405.1820384,21.48059555$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,615,48.654,0.974,500.7836226,13.30567543$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,635,48.339,0.97,497.5414053,13.23742269$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,665,50.991,1.037,524.8377872,14.07097013$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,725,61.81,1.037,636.195086,15.40942613$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,785,68.752,1.471,707.6473799,19.54657967$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,870,74.66,1.677,768.4569668,21.86697494$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,900,68.55,2.27,788.1062217,29.46728207$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,920,62.92,1.299,723.3791899,19.51337335$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,955,56.9932,1.1697,655.2399054,17.61430859$CAR1505-g4,UO2-P-Xe-800-2.25e11--A3578-4,-,129,0,1.125E+11,1005,51.954,1.086,597.305188,16.23066211$'
data='/_IDsample,sample.titre,Export_sample.plus,ref,Export_FlagBad,sample.Fluence,time_m,N,N_e,Nt,Nt_e$' \
     'CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,510,0,0,0,0$' \
     'CAR1505-g1,UO2-P-Xe-800-2.25e11--A3875-3,-,129,0,1.125E+11,525,126.2857143,6.392980845,1118.2308$'

myrelax=relaxDash.Relax('0',data)

app.layout = html.Div([
        dcc.Location(id='url',refresh=True),
        dcc.Graph( id='mygraph',figure=myrelax.PlotReturns,style={'width': '90vw', 'height': '90vh'}),
        dcc.Input(id='input', value='0', type="text", placeholder='x,y,z', debounce=True),
        html.Div(id='my-output')
])

@app.callback(Output('mygraph', 'figure'),
              Input("input", "value"),
              Input('url','pathname'))

def update_plot(value,pathname): #orde dsparametres = ordre des input
    myrd=relaxDash.Relax(value,pathname)
    f=open('out.txt','w')
    f.write(myrd.dataReturn)
    f.close()
    return myrd.PlotReturns    #orde des returns= ordre  des output si plus de 1

@app.callback(
    Output('my-output', 'children'),
    Input('url', 'pathname'))

def callback_func(pathname):
    return ''

if __name__ == "__main__":
    app.run_server(host='0.0.0.0',debug=True,port=8060)
